@model mct_timer.Models.Background

<div id="optChoise">
    <table>
        <tr>
            <td>
                <div class="submit" id="toUpload" style="cursor:pointer;padding:10px">
                    <div><img src="~/icons/upload.png" style="width:50px" /></div>
                    <div>Upload</div>
                </div>
            </td>            <td>
                <div class="submit" id="toGenerate" style="cursor:pointer;">
                    <div><img src="~/icons/ai.png" style="width:50px" /></div>
                    <div>AI Generate</div>
                </div>
       
            </td>
        </tr>
    </table>
</div>

<div id="optUpload" style="display:none">
    <form id="uploadForm" method="post" action="~/settings/UploadPhysical"
          enctype="multipart/form-data"
          onsubmit="javascript:AJAXSubmit(this);return false">

        <div calss="info">
            <b>
                Upload your new background.
            </b>
        </div>
        <div calss="info">JPEG and PNG files accepted with size limit 3.5 MB</div>
        <div>
            <div id="upload">
                <input id="file" type="file" name="file" class="form-control-text" />
                <input value="Upload" id="btnUpload" type="submit" class="submit" />
                <input type="button" value="Cancel" class="back" />
            </div>
            <div id="progress" class="the-progress" style="visibility:hidden">
                <progress max="100" value="100">
                </progress>
            </div>
            <div>
                <output class="error" form="uploadForm" id="result" name="result"></output>                
            </div>
        </div>
    </form>
</div>

<div id="optSubmit" style="display:none">
    <form asp-action="UploadBG">
        <table cellpadding="5" style="max-width:775px;">
                <tr>
                    <td valign="top" >
                    <div class="control-label-nowrap"><span class="required">*</span>Tell us more about your image you uploading:</div>
                    </td>
                <td valign="top" align="right" style="width:100%;">
                            <label class="control-label">Break Type:</label>                            <select id="BgType" name="BgType" style="padding:1px;margin:10px;font-size:13pt">
                                @foreach (PresetType val in Enum.GetValues(typeof(PresetType)))
                                {
                                    var dic = ViewData["UplodaQuote"] as Dictionary<PresetType, int>;

                                    if (dic != null && (!dic.ContainsKey(val) || (dic.ContainsKey(val) && dic[val] < 5)))
                                    {
                                        <option value="@val">@val</option>
                                    }
                                }
                            </select>
                    </td>
                </tr>
            <tr>
                <td colspan="2">
                    <textarea id="uplInfo" style="width:100%" rows="2" type="text" asp-for="Info" class="form-control-text"></textarea>
                    <span asp-validation-for="Info" class="text-danger"></span>
                </td>
            </tr>
                <tr><td colspan="2">
                <input style="width:180px"
                           type="button" value="Create" class="submit" onclick="submitForm(this.form,document.getElementById('uplInfo'))" />
                    <input style="width:180px"
                           type="button" value="Cancel" class="back" />
                </td>
                </tr>
            </table>
    </form>
</div>

<div id="optGenerate" style="display:none">
    @{
        bool canGenerateAICheck = (ViewData["CanGenerateAI"] as bool?) ?? false;
        string? aiAvailableInTime = ViewData["AIAvailableIn"] as string;
        int attemptsCount = (ViewData["Attempts"] as int?) ?? 0;
    }

    @if (!canGenerateAICheck && !string.IsNullOrEmpty(aiAvailableInTime))
    {
        <div style="text-align: center; padding: 30px; background-color: #f9f9f9; border: 2px solid #ddd; border-radius: 8px; margin-bottom: 20px;">
            <div style="font-size: 18px; font-weight: bold; color: #d9534f; margin-bottom: 10px;">
                AI Generation Limit Reached
            </div>
            <div style="font-size: 16px; color: #666; margin-bottom: 15px;">
                You've used all your AI generation attempts for the next 24 hours.
            </div>
            <div style="font-size: 20px; font-weight: bold; color: #0275d8; padding: 10px; background-color: #e7f3ff; border-radius: 5px;">
                Get back in <strong>@aiAvailableInTime</strong>
            </div>
        </div>
    }
    else if (canGenerateAICheck)
    {
        <form asp-action="GenerateBG">
            <div calss="info">
                <i>
                    You have @attemptsCount attempts to generate AI background in next 24 hours.
                </i>
            </div>

            <table cellpadding="5" style="max-width:775px;">
                <tr>
                    <td valign="top"> 
                        <div class="control-label-nowrap"><span class="required">*</span>Explain to AI what to generate (prompt):</div>
                    </td>
                    <td valign="top"  align="right" style="width:100%;">
                        <label class="control-label">Break Type:</label>                        <select id="BgType" name="BgType" style="padding:1px;margin:10px;font-size:13pt">
                            @foreach (PresetType val in Enum.GetValues(typeof(PresetType)))
                            {
                                var dic = ViewData["UplodaQuote"] as Dictionary<PresetType, int>;

                                if (dic != null && (!dic.ContainsKey(val) || (dic.ContainsKey(val) && dic[val] < 5)))
                                {
                                    <option value="@val">@val</option>
                                }
                            }
                        </select>
                    </td>
                </tr>            
                <tr>
                    <td colspan="2">
                        <textarea id="genInfo" style="width:100%" rows="2" type="text" asp-for="Info" class="form-control-text" placeholder="Describe what AI should generate..." oninput="updatePromptValidation()"></textarea>
                        <span asp-validation-for="Info" class="text-danger"></span>
                        <div id="genValidationMessage" style="color: #666; font-size: 12px; margin-top: 5px;"></div>
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        <altcha-widget challengeurl="/Account/GetAltcha"></altcha-widget>
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        <input id="create" style="width:180px"
                               type="button" value="Generate" class="submit" onclick="submitGenerateForm(this.form,document.getElementById('genInfo'))" />
                         <input style="width:180px"
                               type="button" value="Cancel" class="back" />
                           </td>
                </tr>
            </table>
        </form>
    }
</div>




